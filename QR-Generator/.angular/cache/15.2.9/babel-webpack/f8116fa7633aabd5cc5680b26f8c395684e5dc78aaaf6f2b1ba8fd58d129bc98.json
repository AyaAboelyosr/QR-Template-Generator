{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/qrtemplategenerator/services/template.service\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = [\"addSectionModal\"];\nconst _c1 = [\"addFieldModal\"];\nconst _c2 = function (a0) {\n  return {\n    $implicit: a0\n  };\n};\nfunction TemplateDetailsComponent_ng_template_0_ng_container_11_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 8);\n    i0.ɵɵelementContainer(2, 14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const section_r7 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵnextContext(2);\n    const _r2 = i0.ɵɵreference(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r2)(\"ngTemplateOutletContext\", i0.ɵɵpureFunction1(2, _c2, section_r7.fields));\n  }\n}\nfunction TemplateDetailsComponent_ng_template_0_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"tr\")(2, \"td\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\")(7, \"div\", 10)(8, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_0_ng_container_11_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const section_r7 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.editSection(section_r7));\n    });\n    i0.ɵɵtext(9, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_0_ng_container_11_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const section_r7 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.deleteSection(section_r7));\n    });\n    i0.ɵɵtext(11, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_0_ng_container_11_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const section_r7 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.toggleFields(section_r7));\n    });\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(14, TemplateDetailsComponent_ng_template_0_ng_container_11_tr_14_Template, 3, 4, \"tr\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const section_r7 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(section_r7.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(section_r7.type);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate1(\" \", section_r7.expanded ? \"Hide Fields\" : \"View Fields\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", section_r7.expanded);\n  }\n}\nfunction TemplateDetailsComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"table\", 5)(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"Section Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\", 6);\n    i0.ɵɵtext(9, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"tbody\");\n    i0.ɵɵtemplate(11, TemplateDetailsComponent_ng_template_0_ng_container_11_Template, 15, 4, \"ng-container\", 7);\n    i0.ɵɵelementStart(12, \"tr\")(13, \"td\", 8)(14, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_0_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.addSection());\n    });\n    i0.ɵɵtext(15, \"Add Section\");\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const sections_r5 = ctx.sections;\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngForOf\", sections_r5);\n  }\n}\nfunction TemplateDetailsComponent_ng_template_2_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"tr\")(2, \"td\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\")(9, \"div\", 10)(10, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_2_ng_container_13_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const field_r18 = restoredCtx.$implicit;\n      const ctx_r19 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r19.editField(field_r18));\n    });\n    i0.ɵɵtext(11, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_2_ng_container_13_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const field_r18 = restoredCtx.$implicit;\n      const ctx_r21 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r21.deleteField(field_r18));\n    });\n    i0.ɵɵtext(13, \"Delete\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r18 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(field_r18.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(field_r18.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(field_r18.isRequired ? \"Yes\" : \"No\");\n  }\n}\nfunction TemplateDetailsComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"table\", 5)(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"Field Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Required\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 6);\n    i0.ɵɵtext(11, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"tbody\");\n    i0.ɵɵtemplate(13, TemplateDetailsComponent_ng_template_2_ng_container_13_Template, 14, 3, \"ng-container\", 7);\n    i0.ɵɵelementStart(14, \"tr\")(15, \"td\", 15)(16, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_ng_template_2_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.addField());\n    });\n    i0.ɵɵtext(17, \"Add Field\");\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const fields_r16 = ctx.fields;\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", fields_r16);\n  }\n}\nconst _c3 = function (a0) {\n  return {\n    sections: a0\n  };\n};\nfunction TemplateDetailsComponent_ng_container_5_ng_container_4_tr_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 15);\n    i0.ɵɵelementContainer(2, 14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const template_r25 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵnextContext(2);\n    const _r0 = i0.ɵɵreference(1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r0)(\"ngTemplateOutletContext\", i0.ɵɵpureFunction1(2, _c3, template_r25.sections));\n  }\n}\nfunction TemplateDetailsComponent_ng_container_5_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"tr\");\n    i0.ɵɵtemplate(2, TemplateDetailsComponent_ng_container_5_ng_container_4_tr_2_Template, 3, 4, \"tr\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const template_r25 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", template_r25.expanded);\n  }\n}\nfunction TemplateDetailsComponent_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 4)(2, \"table\", 5)(3, \"tbody\");\n    i0.ɵɵtemplate(4, TemplateDetailsComponent_ng_container_5_ng_container_4_Template, 3, 1, \"ng-container\", 7);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.filteredTemplateList);\n  }\n}\nexport class TemplateDetailsComponent {\n  constructor(fb, templateService) {\n    this.fb = fb;\n    this.templateService = templateService;\n    this.initSectionForm();\n    this.initFieldForm();\n  }\n  initSectionForm() {\n    this.sectionParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required]\n    });\n  }\n  initFieldForm() {\n    this.fieldParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required],\n      isRequired: [false]\n    });\n  }\n  // Section methods\n  editSection(section) {\n    this.sectionParams.reset({\n      id: 0\n    });\n    if (section) {\n      this.sectionParams.patchValue(section);\n    }\n    this.addSectionModal.open();\n  }\n  saveSection() {\n    if (this.sectionParams.invalid) return;\n    const section = this.sectionParams.value;\n    const templateId = this.template.id;\n    if (section.id) {\n      this.templateService.updateSection(templateId.toString(), section.id.toString(), section).subscribe(updated => this.updateSectionInList(updated));\n    } else {\n      this.templateService.addSection(templateId.toString(), section).subscribe(newSection => this.template.sections?.push(newSection));\n    }\n    this.addSectionModal.close();\n  }\n  deleteSection(sectionId) {\n    this.templateService.deleteSection(this.template.id.toString(), sectionId.toString()).subscribe(() => {\n      this.template.sections = this.template.sections?.filter(s => s.id !== sectionId);\n    });\n  }\n  // Field methods\n  editField(section, field) {\n    this.selectedSection = section;\n    this.fieldParams.reset({\n      id: 0\n    });\n    if (field) {\n      this.fieldParams.patchValue(field);\n    }\n    this.addFieldModal.open();\n  }\n  saveField() {\n    if (this.fieldParams.invalid || !this.selectedSection) return;\n    const field = this.fieldParams.value;\n    const sectionId = this.selectedSection.id;\n    if (field.id) {\n      this.templateService.updateField(this.template.id.toString(), sectionId.toString(), field.id.toString(), field).subscribe(updated => this.updateFieldInList(updated));\n    } else {\n      this.templateService.addField(this.template.id.toString(), sectionId.toString(), field).subscribe(newField => this.selectedSection?.fields?.push(newField));\n    }\n    this.addFieldModal.close();\n  }\n  deleteField(section, fieldId) {\n    this.templateService.deleteField(this.template.id.toString(), section.id.toString(), fieldId.toString()).subscribe(() => {\n      section.fields = section.fields?.filter(f => f.id !== fieldId);\n    });\n  }\n  updateSectionInList(updated) {\n    const index = this.template.sections?.findIndex(s => s.id === updated.id) ?? -1;\n    if (index > -1) this.template.sections[index] = updated;\n  }\n  updateFieldInList(updated) {\n    const index = this.selectedSection?.fields?.findIndex(f => f.id === updated.id) ?? -1;\n    if (index > -1) this.selectedSection.fields[index] = updated;\n  }\n  toggleFields(section) {\n    section.expanded = !section.expanded;\n    if (!section.fields) {\n      this.templateService.getSectionFields(this.template.id.toString(), section.id.toString()).subscribe(fields => section.fields = fields);\n    }\n  }\n  static #_ = this.ɵfac = function TemplateDetailsComponent_Factory(t) {\n    return new (t || TemplateDetailsComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.TemplateService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TemplateDetailsComponent,\n    selectors: [[\"app-template-details\"]],\n    viewQuery: function TemplateDetailsComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.addSectionModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.addFieldModal = _t.first);\n      }\n    },\n    inputs: {\n      template: \"template\"\n    },\n    decls: 6,\n    vars: 1,\n    consts: [[\"sectionTemplate\", \"\"], [\"fieldTemplate\", \"\"], [1, \"panel\", \"mt-5\", \"overflow-hidden\", \"border-0\", \"p-0\"], [4, \"ngIf\"], [1, \"table-responsive\"], [1, \"table-striped\", \"table-hover\"], [1, \"!text-center\"], [4, \"ngFor\", \"ngForOf\"], [\"colspan\", \"3\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-outline-success\", 3, \"click\"], [1, \"flex\", \"items-center\", \"justify-center\", \"gap-4\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-outline-primary\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-outline-danger\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-outline-secondary\", 3, \"click\"], [3, \"ngTemplateOutlet\", \"ngTemplateOutletContext\"], [\"colspan\", \"4\"]],\n    template: function TemplateDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, TemplateDetailsComponent_ng_template_0_Template, 16, 1, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(2, TemplateDetailsComponent_ng_template_2_Template, 18, 1, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementStart(4, \"div\", 2);\n        i0.ɵɵtemplate(5, TemplateDetailsComponent_ng_container_5_Template, 5, 1, \"ng-container\", 3);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayType === \"list\");\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i3.NgTemplateOutlet],\n    encapsulation: 2\n  });\n}","map":{"version":3,"mappings":"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","names":["Validators","i0","TemplateDetailsComponent","constructor","fb","templateService","initSectionForm","initFieldForm","sectionParams","group","id","title","required","minLength","maxLength","type","fieldParams","isRequired","editSection","section","reset","patchValue","addSectionModal","open","saveSection","invalid","value","templateId","template","updateSection","toString","subscribe","updated","updateSectionInList","addSection","newSection","sections","push","close","deleteSection","sectionId","filter","s","editField","field","selectedSection","addFieldModal","saveField","updateField","updateFieldInList","addField","newField","fields","deleteField","fieldId","f","index","findIndex","toggleFields","expanded","getSectionFields","selectors","viewQuery"],"sourceRoot":"","sources":["C:\\Users\\Electronica Care\\Downloads\\QRCodeGenerator-main\\QR-Generator\\src\\app\\qrtemplategenerator\\components\\template-details\\template-details.component.ts","C:\\Users\\Electronica Care\\Downloads\\QRCodeGenerator-main\\QR-Generator\\src\\app\\qrtemplategenerator\\components\\template-details\\template-details.component.html"],"sourcesContent":["import { Component, Input, ViewChild } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ModalComponent } from 'angular-custom-modal';\nimport Swal from 'sweetalert2';\nimport { TemplateService } from 'src/app/qrtemplategenerator/services/template.service';\nimport { Template } from 'src/app/qrtemplategenerator/Models/Template';\nimport { Section } from 'src/app/qrtemplategenerator/Models/Section';\nimport { Field } from 'src/app/qrtemplategenerator/Models/Field';\n\n@Component({\n  selector: 'app-template-details',\n  templateUrl: './template-details.component.html'\n})\nexport class TemplateDetailsComponent {\n  @Input() template!: Template;\n  @ViewChild('addSectionModal') addSectionModal!: ModalComponent;\n  @ViewChild('addFieldModal') addFieldModal!: ModalComponent;\n\n  sectionParams!: FormGroup;\n  fieldParams!: FormGroup;\n  selectedSection?: Section;\n\n  constructor(private fb: FormBuilder, private templateService: TemplateService) {\n    this.initSectionForm();\n    this.initFieldForm();\n  }\n\n  initSectionForm() {\n    this.sectionParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required],\n    });\n  }\n\n  initFieldForm() {\n    this.fieldParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required],\n      isRequired: [false],\n    });\n  }\n\n  // Section methods\n  editSection(section?: Section) {\n    this.sectionParams.reset({ id: 0 });\n    if (section) {\n      this.sectionParams.patchValue(section);\n    }\n    this.addSectionModal.open();\n  }\n\n  saveSection() {\n    if (this.sectionParams.invalid) return;\n\n    const section: Section = this.sectionParams.value;\n    const templateId = this.template.id;\n\n    if (section.id) {\n      this.templateService.updateSection(templateId.toString(), section.id.toString(), section)\n        .subscribe(updated => this.updateSectionInList(updated));\n    } else {\n      this.templateService.addSection(templateId.toString(), section)\n        .subscribe(newSection => this.template.sections?.push(newSection));\n    }\n    this.addSectionModal.close();\n  }\n\n  deleteSection(sectionId: number) {\n    this.templateService.deleteSection(this.template.id.toString(), sectionId.toString())\n      .subscribe(() => {\n        this.template.sections = this.template.sections?.filter(s => s.id !== sectionId);\n      });\n  }\n\n  // Field methods\n  editField(section: Section, field?: Field) {\n    this.selectedSection = section;\n    this.fieldParams.reset({ id: 0 });\n    if (field) {\n      this.fieldParams.patchValue(field);\n    }\n    this.addFieldModal.open();\n  }\n\n  saveField() {\n    if (this.fieldParams.invalid || !this.selectedSection) return;\n\n    const field: Field = this.fieldParams.value;\n    const sectionId = this.selectedSection.id;\n\n    if (field.id) {\n      this.templateService.updateField(this.template.id.toString(), sectionId.toString(), field.id.toString(), field)\n        .subscribe(updated => this.updateFieldInList(updated));\n    } else {\n      this.templateService.addField(this.template.id.toString(), sectionId.toString(), field)\n        .subscribe(newField => this.selectedSection?.fields?.push(newField));\n    }\n    this.addFieldModal.close();\n  }\n\n  deleteField(section: Section, fieldId: number) {\n    this.templateService.deleteField(this.template.id.toString(), section.id.toString(), fieldId.toString())\n      .subscribe(() => {\n        section.fields = section.fields?.filter(f => f.id !== fieldId);\n      });\n  }\n\n  private updateSectionInList(updated: Section) {\n    const index = this.template.sections?.findIndex(s => s.id === updated.id) ?? -1;\n    if (index > -1) this.template.sections![index] = updated;\n  }\n\n  private updateFieldInList(updated: Field) {\n    const index = this.selectedSection?.fields?.findIndex(f => f.id === updated.id) ?? -1;\n    if (index > -1) this.selectedSection!.fields![index] = updated;\n  }\n\n  toggleFields(section: Section) {\n    section.expanded = !section.expanded;\n    if (!section.fields) {\n      this.templateService.getSectionFields(this.template.id.toString(), section.id.toString())\n        .subscribe(fields => section.fields = fields);\n    }\n  }\n}","<!-- Sections Table Template -->\n<ng-template #sectionTemplate let-sections=\"sections\">\n    <div class=\"table-responsive\">\n      <table class=\"table-striped table-hover\">\n        <thead>\n          <tr>\n            <th>Section Title</th>\n            <th>Type</th>\n            <th class=\"!text-center\">Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          <ng-container *ngFor=\"let section of sections\">\n            <tr>\n              <td>{{ section.title }}</td>\n              <td>{{ section.type }}</td>\n              <td>\n                <div class=\"flex items-center justify-center gap-4\">\n                  <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \n                    (click)=\"editSection(section)\">Edit</button>\n                  <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \n                    (click)=\"deleteSection(section)\">Delete</button>\n                  <button type=\"button\" class=\"btn btn-sm btn-outline-secondary\" \n                    (click)=\"toggleFields(section)\">\n                    {{ section.expanded ? 'Hide Fields' : 'View Fields' }}\n                  </button>\n                </div>\n              </td>\n            </tr>\n            \n            <!-- Nested Fields Table -->\n            <tr *ngIf=\"section.expanded\">\n              <td colspan=\"3\">\n                <ng-container [ngTemplateOutlet]=\"fieldTemplate\" \n                  [ngTemplateOutletContext]=\"{ $implicit: section.fields }\">\n                </ng-container>\n              </td>\n            </tr>\n          </ng-container>\n          \n          <tr>\n            <td colspan=\"3\">\n              <button type=\"button\" class=\"btn btn-sm btn-outline-success\" \n                (click)=\"addSection()\">Add Section</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </ng-template>\n  \n  <!-- Fields Table Template -->\n  <ng-template #fieldTemplate let-fields=\"fields\">\n    <div class=\"table-responsive\">\n      <table class=\"table-striped table-hover\">\n        <thead>\n          <tr>\n            <th>Field Title</th>\n            <th>Type</th>\n            <th>Required</th>\n            <th class=\"!text-center\">Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          <ng-container *ngFor=\"let field of fields\">\n            <tr>\n              <td>{{ field.title }}</td>\n              <td>{{ field.type }}</td>\n              <td>{{ field.isRequired ? 'Yes' : 'No' }}</td>\n              <td>\n                <div class=\"flex items-center justify-center gap-4\">\n                  <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" \n                    (click)=\"editField(field)\">Edit</button>\n                  <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" \n                    (click)=\"deleteField(field)\">Delete</button>\n                </div>\n              </td>\n            </tr>\n          </ng-container>\n          \n          <tr>\n            <td colspan=\"4\">\n              <button type=\"button\" class=\"btn btn-sm btn-outline-success\" \n                (click)=\"addField()\">Add Field</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </ng-template>\n  \n  <!-- Usage in Main Template -->\n  <div class=\"panel mt-5 overflow-hidden border-0 p-0\">\n    <ng-container *ngIf=\"displayType === 'list'\">\n      <div class=\"table-responsive\">\n        <table class=\"table-striped table-hover\">\n          <!-- Main Template Table -->\n          <tbody>\n            <ng-container *ngFor=\"let template of filteredTemplateList\">\n              <tr>\n                <!-- ... template columns ... -->\n              </tr>\n              \n              <tr *ngIf=\"template.expanded\">\n                <td colspan=\"4\">\n                  <ng-container [ngTemplateOutlet]=\"sectionTemplate\" \n                    [ngTemplateOutletContext]=\"{ sections: template.sections }\">\n                  </ng-container>\n                </td>\n              </tr>\n            </ng-container>\n          </tbody>\n        </table>\n      </div>\n    </ng-container>\n  </div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}