{"ast":null,"code":"import { inject } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { TemplateService } from '../../services/template.service';\nimport { ActivatedRoute } from '@angular/router';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"angular-custom-modal\";\nimport * as i4 from \"@angular/router\";\nconst _c0 = [\"addFieldModal\"];\nconst _c1 = [\"addSectionModal\"];\nfunction TemplateItemComponent_ng_container_26_tr_16_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 37)(1, \"td\", 38);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 38);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 38);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 39)(8, \"div\", 25)(9, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_container_26_tr_16_tr_14_Template_button_click_9_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const field_r14 = restoredCtx.$implicit;\n      const section_r11 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      ctx_r15.editField(section_r11.id, field_r14);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵtext(10, \" Edit \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_container_26_tr_16_tr_14_Template_button_click_11_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const field_r14 = restoredCtx.$implicit;\n      const section_r11 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r18 = i0.ɵɵnextContext();\n      ctx_r18.deleteField(section_r11.id, field_r14.id);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵtext(12, \" Delete \");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const field_r14 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(field_r14.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(field_r14.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(field_r14.isRequired ? \"Yes\" : \"No\");\n  }\n}\nfunction TemplateItemComponent_ng_container_26_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 10)(1, \"td\", 31)(2, \"table\", 32)(3, \"thead\")(4, \"tr\")(5, \"th\", 33);\n    i0.ɵɵtext(6, \"Field Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 33);\n    i0.ɵɵtext(8, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\", 33);\n    i0.ɵɵtext(10, \"Required\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\", 34);\n    i0.ɵɵtext(12, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"tbody\");\n    i0.ɵɵtemplate(14, TemplateItemComponent_ng_container_26_tr_16_tr_14_Template, 13, 3, \"tr\", 35);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"button\", 36);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_container_26_tr_16_Template_button_click_15_listener($event) {\n      i0.ɵɵrestoreView(_r22);\n      const section_r11 = i0.ɵɵnextContext().$implicit;\n      const ctx_r20 = i0.ɵɵnextContext();\n      ctx_r20.openAddFieldModal(section_r11.id);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵtext(16, \" + Add Field \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const section_r11 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngForOf\", section_r11.fields);\n  }\n}\nfunction TemplateItemComponent_ng_container_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"tr\", 22);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_container_26_Template_tr_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r25);\n      const section_r11 = restoredCtx.$implicit;\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.toggleSection(section_r11));\n    });\n    i0.ɵɵelementStart(2, \"td\", 23);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\", 23);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\", 24)(7, \"div\", 25)(8, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_container_26_Template_button_click_8_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r25);\n      const section_r11 = restoredCtx.$implicit;\n      const ctx_r26 = i0.ɵɵnextContext();\n      ctx_r26.editSection(section_r11);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵtext(9, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_container_26_Template_button_click_10_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r25);\n      const section_r11 = restoredCtx.$implicit;\n      const ctx_r27 = i0.ɵɵnextContext();\n      ctx_r27.deleteSection(section_r11.id);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵtext(11, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"span\", 28);\n    i0.ɵɵtext(13, \"|\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 29);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(16, TemplateItemComponent_ng_container_26_tr_16_Template, 17, 1, \"tr\", 30);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const section_r11 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(section_r11.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(section_r11.type);\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate1(\" \", section_r11.expanded ? \"Hide\" : \"Show\", \" Fields \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", section_r11.expanded);\n  }\n}\nfunction TemplateItemComponent_ng_template_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.sectionParams.controls[\"id\"].value ? \"Edit Section\" : \"Add Section\");\n  }\n}\nfunction TemplateItemComponent_ng_template_36_div_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Title is required.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TemplateItemComponent_ng_template_36_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 51);\n    i0.ɵɵtemplate(1, TemplateItemComponent_ng_template_36_div_5_div_1_Template, 2, 0, \"div\", 52);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r28 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r28.sectionParams.controls[\"title\"].errors == null ? null : ctx_r28.sectionParams.controls[\"title\"].errors[\"required\"]);\n  }\n}\nfunction TemplateItemComponent_ng_template_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r31 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 41);\n    i0.ɵɵlistener(\"ngSubmit\", function TemplateItemComponent_ng_template_36_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r31);\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.saveSection());\n    });\n    i0.ɵɵelementStart(1, \"div\", 42)(2, \"label\", 43);\n    i0.ɵɵtext(3, \"Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 44);\n    i0.ɵɵtemplate(5, TemplateItemComponent_ng_template_36_div_5_Template, 2, 1, \"div\", 45);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 42)(7, \"label\");\n    i0.ɵɵtext(8, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\")(10, \"label\");\n    i0.ɵɵelement(11, \"input\", 46);\n    i0.ɵɵtext(12, \" Form \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"label\");\n    i0.ɵɵelement(14, \"input\", 47);\n    i0.ɵɵtext(15, \" Table \");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"div\", 48)(17, \"button\", 49);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_template_36_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r31);\n      i0.ɵɵnextContext();\n      const _r1 = i0.ɵɵreference(33);\n      return i0.ɵɵresetView(_r1.close());\n    });\n    i0.ɵɵtext(18, \"Cancel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"button\", 50);\n    i0.ɵɵtext(20, \"Save\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r5.sectionParams);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.sectionParams.controls[\"title\"].invalid && ctx_r5.sectionParams.controls[\"title\"].touched);\n  }\n}\nfunction TemplateItemComponent_ng_template_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r8.fieldParams.controls[\"id\"].value ? \"Edit Field\" : \"Add Field\");\n  }\n}\nfunction TemplateItemComponent_ng_template_42_div_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Title is required.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TemplateItemComponent_ng_template_42_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 51);\n    i0.ɵɵtemplate(1, TemplateItemComponent_ng_template_42_div_5_div_1_Template, 2, 0, \"div\", 52);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r33 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r33.fieldParams.controls[\"title\"].errors == null ? null : ctx_r33.fieldParams.controls[\"title\"].errors[\"required\"]);\n  }\n}\nfunction TemplateItemComponent_ng_template_42_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r36 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 41);\n    i0.ɵɵlistener(\"ngSubmit\", function TemplateItemComponent_ng_template_42_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r36);\n      const ctx_r35 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r35.saveField());\n    });\n    i0.ɵɵelementStart(1, \"div\", 42)(2, \"label\", 53);\n    i0.ɵɵtext(3, \"Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 54);\n    i0.ɵɵtemplate(5, TemplateItemComponent_ng_template_42_div_5_Template, 2, 1, \"div\", 45);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 42)(7, \"label\", 55);\n    i0.ɵɵtext(8, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"select\", 56)(10, \"option\", 57);\n    i0.ɵɵtext(11, \"Text\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"option\", 58);\n    i0.ɵɵtext(13, \"Number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"option\", 59);\n    i0.ɵɵtext(15, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"option\", 60);\n    i0.ɵɵtext(17, \"Boolean\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"div\", 42)(19, \"label\", 61);\n    i0.ɵɵtext(20, \"Required\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(21, \"input\", 62);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"div\", 48)(23, \"button\", 49);\n    i0.ɵɵlistener(\"click\", function TemplateItemComponent_ng_template_42_Template_button_click_23_listener() {\n      i0.ɵɵrestoreView(_r36);\n      i0.ɵɵnextContext();\n      const _r6 = i0.ɵɵreference(39);\n      return i0.ɵɵresetView(_r6.close());\n    });\n    i0.ɵɵtext(24, \"Cancel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"button\", 50);\n    i0.ɵɵtext(26, \"Save\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r10.fieldParams);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r10.fieldParams.controls[\"title\"].invalid && ctx_r10.fieldParams.controls[\"title\"].touched);\n  }\n}\nexport class TemplateItemComponent {\n  constructor() {\n    this._TemplateService = inject(TemplateService);\n    this._router = inject(ActivatedRoute);\n    this._fb = inject(FormBuilder);\n    this.currentSectionId = null;\n    this.templateData = {};\n    this.displayType = 'grid';\n  }\n  ngOnInit() {\n    this.templateId = this._router.snapshot.paramMap.get('id');\n    this.getTemplatebyId();\n    this.initFieldForm();\n    this.initSectionForm();\n  }\n  initSectionForm() {\n    this.sectionParams = this._fb.group({\n      id: [null],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required]\n    });\n  }\n  initForm() {\n    this.params = this._fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      uniqeCode: ['', [Validators.required, Validators.pattern(/^[A-Z]{2}-\\d{3}$/)]]\n    });\n  }\n  initFieldForm() {\n    this.fieldParams = this._fb.group({\n      id: [null],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['Text', Validators.required],\n      isRequired: [false]\n    });\n  }\n  openAddFieldModal(sectionId) {\n    this.currentSectionId = sectionId;\n    this.fieldParams.reset({\n      type: 'Text',\n      isRequired: false,\n      title: ''\n    });\n    this.addFieldModal.open();\n  }\n  openAddSectionModal() {\n    this.sectionParams.reset({\n      type: 'form'\n    });\n    this.addSectionModal.open();\n  }\n  saveField() {\n    // Validate the form\n    if (this.fieldParams.invalid) {\n      this.showMessage('Please fill all required fields correctly.', 'error');\n      return;\n    }\n    // Check if template data and sections are loaded\n    if (!this.templateData || !this.templateData.sections) {\n      this.showMessage('Template data is not loaded.', 'error');\n      return;\n    }\n    // Check if a section is selected\n    if (!this.currentSectionId) {\n      this.showMessage('No section selected.', 'error');\n      return;\n    }\n    const fieldData = this.fieldParams.value;\n    // Map the field type to the enum value\n    const mappedType = this.mapFieldType(fieldData.type);\n    // Create the payload for the API request\n    const requestData = {\n      title: fieldData.title,\n      type: mappedType,\n      isRequired: fieldData.isRequired\n    };\n    // Find the section\n    const section = this.templateData.sections.find(s => s.id === this.currentSectionId);\n    if (!section) {\n      this.showMessage('Section not found.', 'error');\n      return;\n    }\n    // Ensure fields array is initialized\n    if (!section.fields) {\n      section.fields = [];\n    }\n    this._TemplateService.addField(this.templateId, this.currentSectionId.toString(), requestData).subscribe({\n      next: res => {\n        section.fields.push(res); // Add the new field safely\n        this.showMessage('Field added successfully.', 'success');\n        this.addFieldModal.close();\n      },\n      error: error => {\n        console.error('Error adding field:', error);\n        this.showMessage('Failed to add field.', 'error');\n      }\n    });\n  }\n  getTemplatebyId() {\n    this._TemplateService.getTemplateById(this.templateId).subscribe({\n      next: res => {\n        console.log('Template id', this.templateId);\n        console.log('Result =', res);\n        this.templateData = res;\n      },\n      error: error => {\n        console.error('Error:', error);\n      }\n    });\n  }\n  saveTemplate() {\n    if (!this.templateData.title || !this.templateData.uniqeCode) {\n      this.showMessage('Please fill all required fields.', 'error');\n      return;\n    }\n    const template = {\n      id: this.templateId,\n      title: this.templateData.title,\n      uniqeCode: this.templateData.uniqeCode\n    };\n    // Update the template\n    this._TemplateService.updateTemplate(this.templateId, template).subscribe({\n      next: () => {\n        this.showMessage('Template updated successfully.', 'success');\n      },\n      error: error => {\n        console.error('Error updating template:', error);\n        this.showMessage('Failed to update template.', 'error');\n      }\n    });\n  }\n  showMessage(msg, type = 'success') {\n    Swal.fire({\n      icon: type,\n      title: msg,\n      toast: true,\n      position: 'top',\n      showConfirmButton: false,\n      timer: 3000,\n      customClass: {\n        container: 'toast'\n      }\n    });\n  }\n  toggleSection(section) {\n    section.expanded = !section.expanded;\n  }\n  toggleField(field) {\n    field.expanded = !field.expanded;\n  }\n  addSection() {\n    const newSection = {\n      title: 'New Section',\n      type: this.mapSectionType('Form'),\n      fields: [],\n      expanded: false\n    };\n    this._TemplateService.addSection(this.templateId, newSection).subscribe({\n      next: res => {\n        this.templateData.sections.push(res); // Add the new section to the template\n        this.showMessage('Section added successfully.', 'success'); // Show success message\n      },\n\n      error: error => {\n        console.error('Error adding section:', error);\n        this.showMessage('Failed to add section.', 'error'); // Show error message\n      }\n    });\n  }\n  // The mapSectionType method\n  mapSectionType(type) {\n    const sectionTypeMap = {\n      'form': 0,\n      'table': 1 // Assuming 1 is for \"Table\"\n    };\n\n    return sectionTypeMap[type.toLowerCase()] ?? 0; // Default to 0 if the type is not found\n  }\n\n  saveSection() {\n    if (this.sectionParams.invalid) {\n      console.log('Form is invalid');\n      this.showMessage('Form is invalid', 'error');\n      return;\n    }\n    const sectionData = this.sectionParams.value;\n    // Ensure title is not empty\n    if (!sectionData.title || sectionData.title.trim() === '') {\n      console.error('Title is required');\n      this.showMessage('Title is required', 'error');\n      return;\n    }\n    const requestData = {\n      id: sectionData.id,\n      title: sectionData.title,\n      type: this.mapSectionType(sectionData.type)\n    };\n    if (sectionData.id) {\n      // Edit existing section\n      this._TemplateService.updateSection(this.templateId, sectionData.id.toString(), requestData).subscribe({\n        next: res => {\n          const sectionIndex = this.templateData.sections.findIndex(s => s.id === sectionData.id);\n          if (sectionIndex !== -1) {\n            this.templateData.sections[sectionIndex] = res;\n          }\n          this.showMessage('Section updated successfully', 'success');\n          this.addSectionModal.close();\n        },\n        error: error => {\n          console.error('Error updating section:', error);\n          this.showMessage('Error updating section', 'error');\n        }\n      });\n    } else {\n      // Add new section\n      this._TemplateService.addSection(this.templateId, requestData).subscribe({\n        next: res => {\n          this.templateData.sections.push(res);\n          this.showMessage('Section added successfully', 'success');\n          this.addSectionModal.close();\n        },\n        error: error => {\n          console.error('Error adding section:', error);\n          this.showMessage('Error adding section', 'error');\n        }\n      });\n    }\n  }\n  editSection(section) {\n    // Initialize the form before setting values\n    this.initSectionForm();\n    // If a section is provided, set the form values for the selected section\n    if (section) {\n      this.sectionParams.setValue({\n        id: section.id,\n        title: section.title,\n        type: section.type\n      });\n    }\n    // Open the modal to edit the section\n    this.addSectionModal.open();\n  }\n  deleteSection(sectionId) {\n    Swal.fire({\n      title: 'Are you sure?',\n      text: 'You won’t be able to revert this!',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#d33',\n      cancelButtonColor: '#3085d6',\n      confirmButtonText: 'Yes, delete it!'\n    }).then(result => {\n      if (result.isConfirmed) {\n        this._TemplateService.deleteSection(this.templateId, sectionId.toString()).subscribe({\n          next: () => {\n            this.templateData.sections = this.templateData.sections.filter(s => s.id !== sectionId);\n            this.showMessage('Section deleted successfully', 'success');\n          },\n          error: error => {\n            console.error('Error deleting section:', error);\n            this.showMessage('Error deleting section', 'error');\n          }\n        });\n      }\n    });\n  }\n  // field methods \n  addField(sectionId) {\n    const newField = {\n      title: '',\n      type: 'Text',\n      isRequired: false,\n      expanded: false\n    };\n    // Convert sectionId to string before passing it to the service\n    this._TemplateService.addField(this.templateId, sectionId.toString(), newField).subscribe({\n      next: res => {\n        const section = this.templateData.sections.find(s => s.id === sectionId);\n        if (section) {\n          section.fields.push(res);\n        }\n      },\n      error: error => {\n        console.error('Error adding field:', error);\n      }\n    });\n  }\n  editField(sectionId, field) {\n    this.currentSectionId = sectionId;\n    this.fieldParams.patchValue(field); // Populate the form with the field data\n    this.addFieldModal.open(); // Open the modal to edit the field\n  }\n\n  deleteField(sectionId, fieldId) {\n    Swal.fire({\n      title: 'Are you sure?',\n      text: 'This field will be permanently deleted!',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#d33',\n      cancelButtonColor: '#3085d6',\n      confirmButtonText: 'Yes, delete it!'\n    }).then(result => {\n      if (result.isConfirmed) {\n        this._TemplateService.deleteField(this.templateId, sectionId.toString(), fieldId.toString()).subscribe({\n          next: () => {\n            const section = this.templateData.sections.find(s => s.id === sectionId);\n            if (section) {\n              section.fields = section.fields.filter(f => f.id !== fieldId);\n            }\n            this.showMessage('Field has been deleted successfully.', 'success');\n          },\n          error: error => {\n            console.error('Error deleting field:', error);\n            this.showMessage('Error deleting field', 'error');\n          }\n        });\n      }\n    });\n  }\n  mapFieldType(type) {\n    const fieldTypeMap = {\n      'Text': 0,\n      'Number': 1,\n      'Date': 2,\n      'Boolean': 3\n    };\n    return fieldTypeMap[type] ?? 0; // Default to 0 (Text) if the type is not found\n  }\n\n  editTemplate(template = null) {\n    this.initForm();\n    if (template) {\n      this.params.setValue({\n        id: template.id,\n        title: template.title,\n        uniqeCode: template.uniqeCode\n      });\n    }\n  }\n  static #_ = this.ɵfac = function TemplateItemComponent_Factory(t) {\n    return new (t || TemplateItemComponent)();\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TemplateItemComponent,\n    selectors: [[\"app-template-item\"]],\n    viewQuery: function TemplateItemComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.addFieldModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.addSectionModal = _t.first);\n      }\n    },\n    decls: 44,\n    vars: 3,\n    consts: [[1, \"container\", \"mx-auto\", \"p-6\"], [1, \"bg-white\", \"shadow-md\", \"rounded-lg\", \"p-6\"], [1, \"text-xl\", \"font-semibold\", \"mb-4\"], [1, \"grid\", \"grid-cols-3\", \"gap-4\", \"border-b\", \"pb-4\", \"mb-4\", \"items-end\"], [1, \"font-bold\", \"block\", \"mb-1\"], [\"type\", \"text\", \"name\", \"uniqueCode\", 1, \"w-full\", \"border\", \"border-gray-300\", \"rounded-md\", \"p-2\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"title\", 1, \"w-full\", \"border\", \"border-gray-300\", \"rounded-md\", \"p-2\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\", 3, \"ngModel\", \"ngModelChange\"], [1, \"flex\", \"items-end\"], [\"type\", \"button\", 1, \"bg-blue-500\", \"text-white\", \"px-4\", \"py-2\", \"rounded-md\", \"hover:bg-blue-600\", \"transition\", 3, \"click\"], [1, \"w-full\", \"border-collapse\"], [1, \"bg-gray-50\"], [1, \"text-left\", \"p-3\", \"border-b\"], [1, \"text-right\", \"p-3\", \"border-b\"], [4, \"ngFor\", \"ngForOf\"], [1, \"bg-green-500\", \"text-white\", \"px-4\", \"py-2\", \"rounded\", \"hover:bg-green-600\", \"mt-4\", 3, \"click\"], [1, \"mt-4\"], [\"routerLink\", \"/admin/list-template\", 1, \"text-blue-500\", \"hover:underline\"], [1, \"no-footer\"], [\"addSectionModal\", \"\"], [\"modalHeader\", \"\"], [\"modalBody\", \"\"], [\"addFieldModal\", \"\"], [1, \"hover:bg-gray-50\", \"cursor-pointer\", \"border-b\", 3, \"click\"], [1, \"p-3\"], [1, \"p-3\", \"text-right\"], [1, \"flex\", \"gap-3\", \"justify-end\"], [1, \"btn\", \"btn-sm\", \"btn-outline-primary\", 3, \"click\"], [1, \"btn\", \"btn-sm\", \"btn-outline-danger\", 3, \"click\"], [1, \"text-gray-400\"], [1, \"btn\", \"btn-sm\", \"btn-outline-secondary\"], [\"class\", \"bg-gray-50\", 4, \"ngIf\"], [\"colspan\", \"3\", 1, \"p-3\"], [1, \"w-full\"], [1, \"text-left\", \"p-2\"], [1, \"text-right\", \"p-2\"], [\"class\", \"hover:bg-gray-100\", 4, \"ngFor\", \"ngForOf\"], [1, \"bg-blue-500\", \"text-white\", \"px-4\", \"py-2\", \"rounded\", \"hover:bg-blue-600\", \"mt-2\", \"ml-2\", 3, \"click\"], [1, \"hover:bg-gray-100\"], [1, \"p-2\", \"border-t\"], [1, \"p-2\", \"border-t\", \"text-right\"], [1, \"!font-medium\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"mb-5\"], [\"for\", \"sectionTitle\"], [\"id\", \"sectionTitle\", \"type\", \"text\", \"formControlName\", \"title\", \"placeholder\", \"Enter Title\", 1, \"form-input\"], [\"class\", \"text-red-500\", 4, \"ngIf\"], [\"type\", \"radio\", \"formControlName\", \"type\", \"value\", \"form\"], [\"type\", \"radio\", \"formControlName\", \"type\", \"value\", \"table\"], [1, \"mt-8\", \"flex\", \"items-center\", \"justify-end\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-danger\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"ltr:ml-4\", \"rtl:ml-4\"], [1, \"text-red-500\"], [4, \"ngIf\"], [\"for\", \"fieldTitle\"], [\"id\", \"fieldTitle\", \"type\", \"text\", \"formControlName\", \"title\", \"placeholder\", \"Enter Title\", 1, \"form-input\"], [\"for\", \"fieldType\"], [\"id\", \"fieldType\", \"formControlName\", \"type\", 1, \"form-select\"], [\"value\", \"Text\"], [\"value\", \"Number\"], [\"value\", \"Date\"], [\"value\", \"Boolean\"], [\"for\", \"isRequired\"], [\"id\", \"isRequired\", \"type\", \"checkbox\", \"formControlName\", \"isRequired\"]],\n    template: function TemplateItemComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\", 2);\n        i0.ɵɵtext(3, \"Template Details\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"form\", 3)(5, \"div\")(6, \"label\", 4);\n        i0.ɵɵtext(7, \"Unique Code:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function TemplateItemComponent_Template_input_ngModelChange_8_listener($event) {\n          return ctx.templateData.uniqeCode = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\")(10, \"label\", 4);\n        i0.ɵɵtext(11, \"Title:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function TemplateItemComponent_Template_input_ngModelChange_12_listener($event) {\n          return ctx.templateData.title = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"div\", 7)(14, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function TemplateItemComponent_Template_button_click_14_listener() {\n          return ctx.saveTemplate();\n        });\n        i0.ɵɵtext(15, \" Save \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"table\", 9)(17, \"thead\", 10)(18, \"tr\")(19, \"th\", 11);\n        i0.ɵɵtext(20, \"Section Title\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"th\", 11);\n        i0.ɵɵtext(22, \"Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"th\", 12);\n        i0.ɵɵtext(24, \"Actions\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(25, \"tbody\");\n        i0.ɵɵtemplate(26, TemplateItemComponent_ng_container_26_Template, 17, 4, \"ng-container\", 13);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(27, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function TemplateItemComponent_Template_button_click_27_listener() {\n          return ctx.openAddSectionModal();\n        });\n        i0.ɵɵtext(28, \"Add Section\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 15)(30, \"button\", 16);\n        i0.ɵɵtext(31, \"Back to List\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(32, \"modal\", 17, 18);\n        i0.ɵɵtemplate(34, TemplateItemComponent_ng_template_34_Template, 2, 1, \"ng-template\", null, 19, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(36, TemplateItemComponent_ng_template_36_Template, 21, 2, \"ng-template\", null, 20, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"modal\", 17, 21);\n        i0.ɵɵtemplate(40, TemplateItemComponent_ng_template_40_Template, 2, 1, \"ng-template\", null, 19, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(42, TemplateItemComponent_ng_template_42_Template, 27, 2, \"ng-template\", null, 20, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngModel\", ctx.templateData.uniqeCode);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.templateData.title);\n        i0.ɵɵadvance(14);\n        i0.ɵɵproperty(\"ngForOf\", ctx.templateData.sections);\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.CheckboxControlValueAccessor, i2.SelectControlValueAccessor, i2.RadioControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.NgModel, i2.NgForm, i3.ModalComponent, i2.FormGroupDirective, i2.FormControlName, i4.RouterLink],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ0ZW1wbGF0ZS1pdGVtLmNvbXBvbmVudC5jc3MifQ== */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcXJ0ZW1wbGF0ZWdlbmVyYXRvci9jb21wb25lbnRzL3RlbXBsYXRlLWl0ZW0vdGVtcGxhdGUtaXRlbS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSw0S0FBNEsiLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["inject","FormBuilder","Validators","TemplateService","ActivatedRoute","Swal","i0","ctx_r15","ctx_r18","ctx_r20","ctx_r26","ctx_r27","TemplateItemComponent","constructor","ngOnInit","templateId","_router","snapshot","paramMap","get","getTemplatebyId","initFieldForm","initSectionForm","sectionParams","_fb","group","id","title","required","minLength","maxLength","type","initForm","params","uniqeCode","pattern","fieldParams","isRequired","openAddFieldModal","sectionId","currentSectionId","reset","addFieldModal","open","openAddSectionModal","addSectionModal","saveField","invalid","showMessage","templateData","sections","fieldData","value","mappedType","mapFieldType","requestData","section","find","s","fields","_TemplateService","addField","toString","subscribe","next","res","push","close","error","console","getTemplateById","log","saveTemplate","template","updateTemplate","msg","fire","icon","toast","position","showConfirmButton","timer","customClass","container","toggleSection","expanded","toggleField","field","addSection","newSection","mapSectionType","sectionTypeMap","toLowerCase","saveSection","sectionData","trim","updateSection","sectionIndex","findIndex","editSection","setValue","deleteSection","text","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","then","result","isConfirmed","filter","newField","editField","patchValue","deleteField","fieldId","f","fieldTypeMap","editTemplate","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\Electronica Care\\Downloads\\QRCodeGenerator-main\\QR-Generator\\src\\app\\qrtemplategenerator\\components\\template-item\\template-item.component.ts","C:\\Users\\Electronica Care\\Downloads\\QRCodeGenerator-main\\QR-Generator\\src\\app\\qrtemplategenerator\\components\\template-item\\template-item.component.html"],"sourcesContent":["import { Component, inject, OnInit, ViewChild } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ModalComponent } from 'angular-custom-modal';\nimport { TemplateService } from '../../services/template.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Template } from '../../Models/Template';\nimport Swal from 'sweetalert2';\n\n\n@Component({\n  selector: 'app-template-item',\n  templateUrl: './template-item.component.html',\n  styleUrls: ['./template-item.component.css']\n})\nexport class TemplateItemComponent implements OnInit {\n  @ViewChild('addFieldModal') addFieldModal!: ModalComponent;\n  @ViewChild('addSectionModal') addSectionModal!: ModalComponent;\n\n  _TemplateService=inject(TemplateService);\n  _router=inject(ActivatedRoute);\n  _fb = inject(FormBuilder);\n  fieldParams!: FormGroup;\n  sectionParams!: FormGroup;\n  currentSectionId: number | null = null;\n  templateData: any = {};\n  displayType: string = 'grid'; \n  templateId!: string;\n  params!: FormGroup;\n  ngOnInit(): void {\n    this.templateId = this._router.snapshot.paramMap.get('id')!; \n    this.getTemplatebyId();\n    this.initFieldForm();\n    this.initSectionForm();\n  }\n\n  initSectionForm(): void {\n    this.sectionParams = this._fb.group({\n      id: [null],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],  // Title validation\n      type: ['', Validators.required]\n    });\n  }\n  \n  initForm() {\n    this.params = this._fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      uniqeCode: ['', [Validators.required, Validators.pattern(/^[A-Z]{2}-\\d{3}$/)]],\n    });\n  }\n\n  initFieldForm(): void {\n    this.fieldParams = this._fb.group({\n      id: [null],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['Text', Validators.required],\n      isRequired: [false]\n    });\n  }\n\n  openAddFieldModal(sectionId: number): void {\n    this.currentSectionId = sectionId;\n    this.fieldParams.reset({ type: 'Text', isRequired: false, title: '' });\n    this.addFieldModal.open();\n  }\n  \n\n  openAddSectionModal(): void {\n    this.sectionParams.reset({ type: 'form' });\n    this.addSectionModal.open();\n  }\n\n  saveField(): void {\n    // Validate the form\n    if (this.fieldParams.invalid) {\n      this.showMessage('Please fill all required fields correctly.', 'error');\n      return;\n    }\n  \n    // Check if template data and sections are loaded\n    if (!this.templateData || !this.templateData.sections) {\n      this.showMessage('Template data is not loaded.', 'error');\n      return;\n    }\n  \n    // Check if a section is selected\n    if (!this.currentSectionId) {\n      this.showMessage('No section selected.', 'error');\n      return;\n    }\n  \n    const fieldData = this.fieldParams.value;\n  \n    // Map the field type to the enum value\n    const mappedType = this.mapFieldType(fieldData.type);\n  \n    // Create the payload for the API request\n    const requestData = {\n      title: fieldData.title,\n      type: mappedType,\n      isRequired: fieldData.isRequired\n    };\n  \n    // Find the section\n    const section = this.templateData.sections.find((s: any) => s.id === this.currentSectionId);\n    if (!section) {\n      this.showMessage('Section not found.', 'error');\n      return;\n    }\n    \n    // Ensure fields array is initialized\n    if (!section.fields) {\n      section.fields = [];\n    }\n    \n    this._TemplateService.addField(this.templateId, this.currentSectionId!.toString(), requestData)\n      .subscribe({\n        next: (res) => {\n          section.fields.push(res);  // Add the new field safely\n          this.showMessage('Field added successfully.', 'success');\n          this.addFieldModal.close();\n        },\n        error: (error) => {\n          console.error('Error adding field:', error);\n          this.showMessage('Failed to add field.', 'error');\n        }\n      });\n    \n    \n  }\n  getTemplatebyId(){\n    this._TemplateService.getTemplateById(this.templateId).subscribe({\n      next: (res) => {\n        console.log( 'Template id',this.templateId);\n        console.log('Result =' ,res);\n        this.templateData = res;\n       \n      },\n      error: (error) => {\n        console.error('Error:', error);\n      }\n\n\n    })\n  }\n\n  saveTemplate(): void {\n    if (!this.templateData.title || !this.templateData.uniqeCode) {\n      this.showMessage('Please fill all required fields.', 'error');\n      return;\n    }\n\n    const template: any = {\n      id: this.templateId,\n      title: this.templateData.title,\n      uniqeCode: this.templateData.uniqeCode\n    };\n\n    // Update the template\n    this._TemplateService.updateTemplate(this.templateId, template).subscribe({\n      next: () => {\n        this.showMessage('Template updated successfully.', 'success');\n      },\n      error: (error) => {\n        console.error('Error updating template:', error);\n        this.showMessage('Failed to update template.', 'error');\n      }\n    });\n  }\n\n   showMessage(msg: string, type: 'success' | 'error' = 'success') {\n      Swal.fire({\n        icon: type,\n        title: msg,\n        toast: true,\n        position: 'top',\n        showConfirmButton: false,\n        timer: 3000,\n        customClass: { container: 'toast' },\n      });\n    }\n  \n  toggleSection(section: any) {\n    section.expanded = !section.expanded;\n  }\n  \n  \n\n  toggleField(field: any): void {\n    field.expanded = !field.expanded;\n  }\n\n  addSection(): void {\n    const newSection = {\n      title: 'New Section',  // Ensure the title is not empty and has at least 3 characters\n      type: this.mapSectionType('Form'), \n      fields: [],\n      expanded: false\n    };\n  \n    this._TemplateService.addSection(this.templateId, newSection).subscribe({\n      next: (res) => {\n        this.templateData.sections.push(res); // Add the new section to the template\n        this.showMessage('Section added successfully.', 'success'); // Show success message\n      },\n      error: (error) => {\n        console.error('Error adding section:', error);\n        this.showMessage('Failed to add section.', 'error'); // Show error message\n      }\n    });\n  }\n  \n  // The mapSectionType method\n  private mapSectionType(type: string): number {\n    const sectionTypeMap: { [key: string]: number } = {\n      'form': 0,   // Assuming 0 is for \"Form\"\n      'table': 1,  // Assuming 1 is for \"Table\"\n    };\n    return sectionTypeMap[type.toLowerCase()] ?? 0;  // Default to 0 if the type is not found\n  }\n  \n\n  saveSection(): void {\n    if (this.sectionParams.invalid) {\n      console.log('Form is invalid');\n      this.showMessage('Form is invalid', 'error');\n      return;\n    }\n  \n    const sectionData = this.sectionParams.value;\n  \n    // Ensure title is not empty\n    if (!sectionData.title || sectionData.title.trim() === '') {\n      console.error('Title is required');\n      this.showMessage('Title is required', 'error');\n      return;\n    }\n  \n    const requestData = {\n      id: sectionData.id,\n      title: sectionData.title,\n      type: this.mapSectionType(sectionData.type),\n    };\n  \n    if (sectionData.id) {\n      // Edit existing section\n      this._TemplateService.updateSection(this.templateId, sectionData.id.toString(), requestData)\n        .subscribe({\n          next: (res) => {\n            const sectionIndex = this.templateData.sections.findIndex((s: any) => s.id === sectionData.id);\n            if (sectionIndex !== -1) {\n              this.templateData.sections[sectionIndex] = res;\n            }\n            this.showMessage('Section updated successfully', 'success');\n            this.addSectionModal.close();\n          },\n          error: (error) => {\n            console.error('Error updating section:', error);\n            this.showMessage('Error updating section', 'error');\n          }\n        });\n    } else {\n      // Add new section\n      this._TemplateService.addSection(this.templateId, requestData)\n        .subscribe({\n          next: (res) => {\n            this.templateData.sections.push(res);\n            this.showMessage('Section added successfully', 'success');\n            this.addSectionModal.close();\n          },\n          error: (error) => {\n            console.error('Error adding section:', error);\n            this.showMessage('Error adding section', 'error');\n          }\n        });\n    }\n  }\n  \n  \n  editSection(section: any): void {\n    // Initialize the form before setting values\n    this.initSectionForm();\n  \n    // If a section is provided, set the form values for the selected section\n    if (section) {\n      this.sectionParams.setValue({\n        id: section.id,\n        title: section.title,\n        type: section.type\n      });\n    }\n  \n    // Open the modal to edit the section\n    this.addSectionModal.open();\n  }\n  \n\n  deleteSection(sectionId: number): void {\n    Swal.fire({\n      title: 'Are you sure?',\n      text: 'You won’t be able to revert this!',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#d33',\n      cancelButtonColor: '#3085d6',\n      confirmButtonText: 'Yes, delete it!'\n    }).then((result) => {\n      if (result.isConfirmed) {\n        this._TemplateService.deleteSection(this.templateId, sectionId.toString()).subscribe({\n          next: () => {\n            this.templateData.sections = this.templateData.sections.filter((s: any) => s.id !== sectionId);\n            this.showMessage('Section deleted successfully', 'success');\n          },\n          error: (error) => {\n            console.error('Error deleting section:', error);\n            this.showMessage('Error deleting section', 'error');\n          }\n        });\n      }\n    });\n  }\n  \n// field methods \n\naddField(sectionId: number): void {\n  const newField = {\n    title: '',\n    type: 'Text', // Default type 'Text'\n    isRequired: false,\n    expanded: false\n  };\n\n  // Convert sectionId to string before passing it to the service\n  this._TemplateService.addField(this.templateId, sectionId.toString(), newField).subscribe({\n    next: (res) => {\n      const section = this.templateData.sections.find((s: any) => s.id === sectionId);\n      if (section) {\n        section.fields.push(res);\n      }\n    },\n    error: (error) => {\n      console.error('Error adding field:', error);\n    }\n  });\n}\n\neditField(sectionId: number, field: any): void {\n  this.currentSectionId = sectionId;\n  this.fieldParams.patchValue(field);  // Populate the form with the field data\n  this.addFieldModal.open();           // Open the modal to edit the field\n}\n\n\ndeleteField(sectionId: number, fieldId: number): void {\n  Swal.fire({\n    title: 'Are you sure?',\n    text: 'This field will be permanently deleted!',\n    icon: 'warning',\n    showCancelButton: true,\n    confirmButtonColor: '#d33',\n    cancelButtonColor: '#3085d6',\n    confirmButtonText: 'Yes, delete it!'\n  }).then((result) => {\n    if (result.isConfirmed) {\n      this._TemplateService.deleteField(this.templateId, sectionId.toString(), fieldId.toString()).subscribe({\n        next: () => {\n          const section = this.templateData.sections.find((s: any) => s.id === sectionId);\n          if (section) {\n            section.fields = section.fields.filter((f: any) => f.id !== fieldId);\n          }\n          this.showMessage('Field has been deleted successfully.', 'success');\n        },\n        error: (error) => {\n          console.error('Error deleting field:', error);\n          this.showMessage('Error deleting field', 'error');\n        }\n      });\n    }\n  });\n}\n\n\n\n\nprivate mapFieldType(type: string): number {\n  const fieldTypeMap: { [key: string]: number } = {\n    'Text': 0,\n    'Number': 1,\n    'Date': 2,\n    'Boolean': 3\n  };\n  return fieldTypeMap[type] ?? 0; // Default to 0 (Text) if the type is not found\n}\n\n editTemplate(template: Template | null = null) {\n  \n      this.initForm();\n      if (template) {\n        this.params.setValue({\n          id: template.id,\n          title: template.title,\n          uniqeCode: template.uniqeCode,\n        });\n      }\n   \n  }\n\n\n\n}\n","\n\n   <div class=\"container mx-auto p-6\">\n    <div class=\"bg-white shadow-md rounded-lg p-6\">\n        <h2 class=\"text-xl font-semibold mb-4\">Template Details</h2>\n        \n      \n        <form class=\"grid grid-cols-3 gap-4 border-b pb-4 mb-4 items-end\">\n            <div>\n                <label class=\"font-bold block mb-1\">Unique Code:</label>\n                <input type=\"text\" [(ngModel)]=\"templateData.uniqeCode\" name=\"uniqueCode\"\n                       class=\"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500\">\n            </div>\n   \n    <div>\n        <label class=\"font-bold block mb-1\">Title:</label>\n        <input type=\"text\" [(ngModel)]=\"templateData.title\" name=\"title\"\n               class=\"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500\">\n    </div>\n\n  \n   \n  \n    <div class=\"flex items-end\">\n        <button type=\"button\" class=\"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition\" (click)=\"saveTemplate()\">\n            Save\n        </button>\n    </div>\n</form>\n\n        \n\n        <!-- Main Table -->\n        <table class=\"w-full border-collapse\">\n            <thead class=\"bg-gray-50\">\n                <tr> \n                    <th class=\"text-left p-3 border-b\">Section Title</th>\n                    <th class=\"text-left p-3 border-b\">Type</th>\n                    <th class=\"text-right p-3 border-b\">Actions</th>\n                </tr>\n            </thead>\n            <tbody>\n                <ng-container *ngFor=\"let section of templateData.sections\">\n                    <!-- Section Row -->\n                    <tr class=\"hover:bg-gray-50 cursor-pointer border-b\" (click)=\"toggleSection(section)\">\n                        <td class=\"p-3\">{{ section.title }}</td>\n                        <td class=\"p-3\">{{ section.type }}</td>\n                        <td class=\"p-3 text-right\">\n                            <div class=\"flex gap-3 justify-end\">\n                                <button class=\"btn btn-sm btn-outline-primary\" (click)=\"editSection(section); $event.stopPropagation()\">Edit</button>\n                                <button class=\"btn btn-sm btn-outline-danger\" (click)=\"deleteSection(section.id); $event.stopPropagation()\">Delete</button>\n                                <span class=\"text-gray-400\">|</span>\n                                <button class=\"btn btn-sm btn-outline-secondary\">\n                                    {{ section.expanded ? 'Hide' : 'Show' }} Fields\n                                </button>\n                            </div>\n                        </td>\n                    </tr>\n\n                    <!-- Fields Sub-table -->\n                    <tr *ngIf=\"section.expanded\" class=\"bg-gray-50\">\n                        <td colspan=\"3\" class=\"p-3\">\n                            <table class=\"w-full\">\n                                <thead>\n                                    <tr>\n                                        <th class=\"text-left p-2\">Field Title</th>\n                                        <th class=\"text-left p-2\">Type</th>\n                                        <th class=\"text-left p-2\">Required</th>\n                                        <th class=\"text-right p-2\">Actions</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    <tr *ngFor=\"let field of section.fields\" class=\"hover:bg-gray-100\">\n                                        <td class=\"p-2 border-t\">{{ field.title }}</td>\n                                        <td class=\"p-2 border-t\">{{ field.type }}</td>\n                                        <td class=\"p-2 border-t\">{{ field.isRequired ? 'Yes' : 'No' }}</td>\n                                        <td class=\"p-2 border-t text-right\">\n                                            <div class=\"flex gap-3 justify-end\">\n                                                <button class=\"btn btn-sm btn-outline-primary\" \n                                                        (click)=\"editField(section.id, field); $event.stopPropagation()\">\n                                                    Edit\n                                                </button>\n                                                <button class=\"btn btn-sm btn-outline-danger\" \n                                                        (click)=\"deleteField(section.id, field.id); $event.stopPropagation()\">\n                                                    Delete\n                                                </button>\n                                            </div>\n                                        </td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                            <button class=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mt-2 ml-2\" \n                                    (click)=\"openAddFieldModal(section.id); $event.stopPropagation()\">\n                                + Add Field\n                            </button>\n                        </td>\n                    </tr>\n                </ng-container>\n            </tbody>\n        </table>\n\n        <!-- Add Section Button -->\n        <button class=\"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mt-4\" (click)=\"openAddSectionModal()\">Add Section</button>\n\n        <div class=\"mt-4\">\n            <button routerLink=\"/admin/list-template\" class=\"text-blue-500 hover:underline\">Back to List</button>\n\n        </div>\n    </div>\n</div>\n\n<!-- Keep all modals EXACTLY as they are in your original code -->\n<!-- Add/Edit Section Modal -->\n<modal #addSectionModal class=\"no-footer\">\n    <ng-template #modalHeader>\n        <div class=\"!font-medium\">{{ sectionParams.controls['id'].value ? 'Edit Section' : 'Add Section' }}</div>\n    </ng-template>\n    <ng-template #modalBody>\n        <form [formGroup]=\"sectionParams\" (ngSubmit)=\"saveSection()\">\n            <div class=\"mb-5\">\n                <label for=\"sectionTitle\">Title</label>\n                <input id=\"sectionTitle\" type=\"text\" class=\"form-input\" formControlName=\"title\" placeholder=\"Enter Title\" />\n                <div *ngIf=\"sectionParams.controls['title'].invalid && sectionParams.controls['title'].touched\" class=\"text-red-500\">\n                    <div *ngIf=\"sectionParams.controls['title'].errors?.['required']\">Title is required.</div>\n                </div>\n            </div>\n            <div class=\"mb-5\">\n                <label>Type</label>\n                <div>\n                    <label>\n                        <input type=\"radio\" formControlName=\"type\" value=\"form\" /> Form\n                    </label>\n                    <label>\n                        <input type=\"radio\" formControlName=\"type\" value=\"table\" /> Table\n                    </label>\n                </div>\n            </div>\n            <div class=\"mt-8 flex items-center justify-end\">\n                <button type=\"button\" class=\"btn btn-outline-danger\" (click)=\"addSectionModal.close()\">Cancel</button>\n                <button type=\"submit\" class=\"btn btn-primary ltr:ml-4 rtl:ml-4\">Save</button>\n            </div>\n        </form>\n    </ng-template>\n</modal>\n\n<!-- Add/Edit Field Modal -->\n<modal #addFieldModal class=\"no-footer\">\n    <ng-template #modalHeader>\n        <div class=\"!font-medium\">{{ fieldParams.controls['id'].value ? 'Edit Field' : 'Add Field' }}</div>\n    </ng-template>\n    <ng-template #modalBody>\n        <form [formGroup]=\"fieldParams\" (ngSubmit)=\"saveField()\">\n            <div class=\"mb-5\">\n                <label for=\"fieldTitle\">Title</label>\n                <input id=\"fieldTitle\" type=\"text\" class=\"form-input\" formControlName=\"title\" placeholder=\"Enter Title\" />\n                <div *ngIf=\"fieldParams.controls['title'].invalid && fieldParams.controls['title'].touched\" class=\"text-red-500\">\n                    <div *ngIf=\"fieldParams.controls['title'].errors?.['required']\">Title is required.</div>\n                </div>\n            </div>\n            <div class=\"mb-5\">\n                <label for=\"fieldType\">Type</label>\n                <select id=\"fieldType\" class=\"form-select\" formControlName=\"type\">\n                    <option value=\"Text\">Text</option>\n                    <option value=\"Number\">Number</option>\n                    <option value=\"Date\">Date</option>\n                    <option value=\"Boolean\">Boolean</option>\n                </select>\n            </div>\n            <div class=\"mb-5\">\n                <label for=\"isRequired\">Required</label>\n                <input id=\"isRequired\" type=\"checkbox\" formControlName=\"isRequired\" />\n            </div>\n            <div class=\"mt-8 flex items-center justify-end\">\n                <button type=\"button\" class=\"btn btn-outline-danger\" (click)=\"addFieldModal.close()\">Cancel</button>\n                <button type=\"submit\" class=\"btn btn-primary ltr:ml-4 rtl:ml-4\">Save</button>\n            </div>\n        </form>\n    </ng-template>\n</modal>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}