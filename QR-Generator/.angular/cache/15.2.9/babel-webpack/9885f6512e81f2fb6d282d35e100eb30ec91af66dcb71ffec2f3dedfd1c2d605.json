{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/qrtemplategenerator/services/template.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"angular-custom-modal\";\nconst _c0 = [\"addSectionModal\"];\nconst _c1 = [\"addFieldModal\"];\nfunction TemplateDetailsComponent_div_8_div_10_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 11)(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_div_8_div_10_div_1_Template_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const field_r8 = restoredCtx.$implicit;\n      const section_r5 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.editField(section_r5, field_r8));\n    });\n    i0.ɵɵtext(5, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_div_8_div_10_div_1_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const field_r8 = restoredCtx.$implicit;\n      const section_r5 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.deleteField(section_r5, field_r8.id));\n    });\n    i0.ɵɵtext(7, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const field_r8 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", field_r8.title, \" (\", field_r8.type, \")\");\n  }\n}\nfunction TemplateDetailsComponent_div_8_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, TemplateDetailsComponent_div_8_div_10_div_1_Template, 8, 2, \"div\", 3);\n    i0.ɵɵelementStart(2, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_div_8_div_10_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const section_r5 = i0.ɵɵnextContext().$implicit;\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.editField(section_r5));\n    });\n    i0.ɵɵtext(3, \"Add Field\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const section_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", section_r5.fields);\n  }\n}\nfunction TemplateDetailsComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 6)(2, \"h4\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_div_8_Template_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const section_r5 = restoredCtx.$implicit;\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.editSection(ctx_r18.template.id, section_r5));\n    });\n    i0.ɵɵtext(5, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_div_8_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const section_r5 = restoredCtx.$implicit;\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.deleteSection(ctx_r20.template.id, section_r5.id));\n    });\n    i0.ɵɵtext(7, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_div_8_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const section_r5 = restoredCtx.$implicit;\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.toggleFieldsVisibility(section_r5));\n    });\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, TemplateDetailsComponent_div_8_div_10_Template, 4, 1, \"div\", 10);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const section_r5 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(section_r5.title);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", section_r5.expanded ? \"Hide\" : \"Show\", \" Fields \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", section_r5.expanded);\n  }\n}\nfunction TemplateDetailsComponent_ng_template_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"h4\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"form\", 13);\n    i0.ɵɵlistener(\"ngSubmit\", function TemplateDetailsComponent_ng_template_11_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.saveSection());\n    });\n    i0.ɵɵelementStart(4, \"div\", 14)(5, \"label\", 15);\n    i0.ɵɵtext(6, \"Section Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 14)(9, \"label\", 17);\n    i0.ɵɵtext(10, \"Section Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"select\", 18)(12, \"option\", 19);\n    i0.ɵɵtext(13, \"Form\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"option\", 20);\n    i0.ɵɵtext(15, \"Table\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"button\", 21);\n    i0.ɵɵtext(17, \"Save\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.sectionParams.value.id ? \"Edit\" : \"Add\", \" Section\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r2.sectionParams);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"disabled\", ctx_r2.sectionParams.invalid);\n  }\n}\nfunction TemplateDetailsComponent_ng_template_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"h4\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"form\", 13);\n    i0.ɵɵlistener(\"ngSubmit\", function TemplateDetailsComponent_ng_template_14_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r26.saveField());\n    });\n    i0.ɵɵelementStart(4, \"div\", 14)(5, \"label\", 15);\n    i0.ɵɵtext(6, \"Field Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 14)(9, \"label\", 17);\n    i0.ɵɵtext(10, \"Field Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"select\", 18)(12, \"option\", 22);\n    i0.ɵɵtext(13, \"Text\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"option\", 23);\n    i0.ɵɵtext(15, \"Number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"option\", 24);\n    i0.ɵɵtext(17, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"option\", 25);\n    i0.ɵɵtext(19, \"Boolean\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"div\", 14)(21, \"label\", 26);\n    i0.ɵɵtext(22, \"Required\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(23, \"input\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"button\", 21);\n    i0.ɵɵtext(25, \"Save\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r4.fieldParams.value.id ? \"Edit\" : \"Add\", \" Field\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r4.fieldParams);\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"disabled\", ctx_r4.fieldParams.invalid);\n  }\n}\nexport class TemplateDetailsComponent {\n  constructor(fb, templateService) {\n    this.fb = fb;\n    this.templateService = templateService;\n    this.template = {\n      id: 0,\n      title: '',\n      uniqeCode: '',\n      sections: []\n    };\n    this.sectionUpdated = new EventEmitter();\n    this.selectedTemplateId = null;\n    this.selectedSectionId = null;\n    this.templateList = [];\n    this.initSectionForm();\n    this.initFieldForm();\n  }\n  ngOnInit() {\n    this.initForm();\n    this.initSectionForm();\n    this.initFieldForm();\n    this.loadTemplates();\n  }\n  ngOnChanges(changes) {\n    if (changes['template']) {\n      console.log('Template received in child component:', this.template);\n    }\n  }\n  initSectionForm() {\n    this.sectionParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required]\n    });\n  }\n  initFieldForm() {\n    this.fieldParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required],\n      isRequired: [false]\n    });\n  }\n  // Section methods\n  editSection(templateId, section = null) {\n    this.selectedTemplateId = templateId;\n    this.addSectionModal.open();\n    this.initSectionForm();\n    if (section) {\n      this.sectionParams.setValue({\n        id: section.id,\n        title: section.title,\n        type: section.type\n      });\n    }\n  }\n  saveSection() {\n    if (this.sectionParams.invalid) {\n      this.showMessage('Please fill all required fields.', 'error');\n      return;\n    }\n    const section = this.sectionParams.value;\n    const templateId = this.selectedTemplateId;\n    if (templateId !== null) {\n      const addSectionDTO = {\n        title: section.title,\n        type: this.mapSectionType(section.type)\n      };\n      if (section.id) {\n        this.templateService.updateSection(templateId.toString(), section.id.toString(), addSectionDTO).subscribe(() => {\n          const template = this.templateList.find(t => t.id === templateId);\n          if (template && template.sections) {\n            const existingSection = template.sections.find(s => s.id === section.id);\n            if (existingSection) {\n              Object.assign(existingSection, section);\n            }\n          }\n          this.showMessage('Section has been updated successfully.');\n          this.addSectionModal.close();\n        }, error => this.handleErrorResponse(error));\n      } else {\n        this.templateService.addSection(templateId.toString(), addSectionDTO).subscribe(newSection => {\n          const template = this.templateList.find(t => t.id === templateId);\n          if (template) {\n            if (!template.sections) {\n              template.sections = [];\n            }\n            template.sections.push(newSection);\n          }\n          this.showMessage('Section has been added successfully.');\n          this.addSectionModal.close();\n        }, error => this.handleErrorResponse(error));\n      }\n    }\n  }\n  mapSectionType(type) {\n    const sectionTypeMap = {\n      'Form': 0,\n      'Table': 1\n    };\n    return sectionTypeMap[type] ?? 0;\n  }\n  handleErrorResponse(error) {\n    console.error('Error response:', error);\n    console.error('Error details:', JSON.stringify(error.error));\n    this.showMessage(error.error?.message || 'An unknown error occurred!', 'error');\n  }\n  showMessage(msg, type = 'success') {\n    Swal.fire({\n      icon: type,\n      title: msg,\n      toast: true,\n      position: 'top',\n      showConfirmButton: false,\n      timer: 3000,\n      customClass: {\n        container: 'toast'\n      }\n    });\n  }\n  deleteSection(templateId, sectionId) {\n    this.templateService.deleteSection(templateId.toString(), sectionId.toString()).subscribe(() => {\n      const template = this.templateList.find(t => t.id === templateId);\n      if (template && template.sections) {\n        template.sections = template.sections.filter(s => s.id !== sectionId);\n      }\n      this.showMessage('Section has been deleted successfully.');\n    }, error => {\n      this.showMessage(error, 'error');\n    });\n  }\n  loadSections(templateId) {\n    this.templateService.getTemplateById(templateId.toString()).subscribe(template => {\n      const existingTemplate = this.templateList.find(t => t.id === templateId);\n      if (existingTemplate) {\n        existingTemplate.sections = template.sections;\n      }\n    });\n  }\n  getTemplateIdBySectionId(sectionId) {\n    for (const template of this.templateList) {\n      if (template.sections) {\n        for (const section of template.sections) {\n          if (section.id === sectionId) {\n            return template.id;\n          }\n        }\n      }\n    }\n    return undefined;\n  }\n  // Field methods\n  editField(section, field = null) {\n    this.selectedSectionId = section.id;\n    const templateId = this.getTemplateIdBySectionId(section.id);\n    this.selectedTemplateId = templateId !== undefined ? templateId : null;\n    this.addFieldModal.open();\n    this.initFieldForm();\n    if (field) {\n      this.fieldParams.setValue({\n        id: field.id,\n        title: field.title,\n        type: field.type,\n        isRequired: field.isRequired\n      });\n    }\n  }\n  saveField() {\n    if (this.fieldParams.invalid) {\n      this.showMessage('Please fill all required fields.', 'error');\n      return;\n    }\n    const field = this.fieldParams.value;\n    const sectionId = this.selectedSectionId;\n    const templateId = this.selectedTemplateId;\n    if (templateId != null && sectionId != null) {\n      const addFieldDTO = {\n        title: field.title,\n        type: this.mapFieldType(field.type),\n        isRequired: field.isRequired\n      };\n      if (field.id != null && field.id !== 0) {\n        // In saveField() update case\n        this.templateService.updateField(templateId.toString(), sectionId.toString(), field.id.toString(), addFieldDTO).subscribe(updatedField => {\n          // Find and update the local field\n          const template = this.templateList.find(t => t.id === templateId);\n          const section = template?.sections?.find(s => s.id === sectionId);\n          if (section?.fields) {\n            const index = section.fields.findIndex(f => f.id === updatedField.id);\n            if (index > -1) {\n              section.fields = [...section.fields.slice(0, index), updatedField, ...section.fields.slice(index + 1)];\n            }\n          }\n          this.showMessage('Field updated successfully');\n          this.addFieldModal.close();\n        }, error => this.handleErrorResponse(error));\n      } else {\n        // In saveField() add case\n        this.templateService.addField(templateId.toString(), sectionId.toString(), addFieldDTO).subscribe(newField => {\n          // Find and update the local data\n          const template = this.templateList.find(t => t.id === templateId);\n          const section = template?.sections?.find(s => s.id === sectionId);\n          if (section) {\n            if (!section.fields) section.fields = [];\n            section.fields = [...section.fields, newField]; // Immutable update\n          }\n\n          this.showMessage('Field added successfully');\n          this.addFieldModal.close();\n        }, error => this.handleErrorResponse(error));\n      }\n    } else {\n      this.showMessage('Template ID or Section ID is missing.', 'error');\n    }\n  }\n  mapFieldType(type) {\n    const fieldTypeMap = {\n      'Text': 0,\n      'Number': 1,\n      'Date': 2,\n      'Boolean': 3\n    };\n    return fieldTypeMap[type];\n  }\n  deleteField(section, fieldId) {\n    const templateId = this.getTemplateIdBySectionId(section.id);\n    if (templateId !== undefined) {\n      this.templateService.deleteField(templateId.toString(), section.id.toString(), fieldId.toString()).subscribe(() => {\n        const template = this.templateList.find(t => t.id === templateId);\n        const existingSection = template?.sections?.find(s => s.id === section.id);\n        if (existingSection && existingSection.fields) {\n          existingSection.fields = existingSection.fields.filter(f => f.id !== fieldId);\n        }\n        this.showMessage('Field has been deleted successfully.');\n      }, error => {\n        this.showMessage(error, 'error');\n      });\n    } else {\n      this.showMessage('Failed to delete field: Template ID is missing.', 'error');\n    }\n  }\n  loadFields(section) {\n    const templateId = this.selectedTemplateId;\n    if (templateId !== null) {\n      this.templateService.getSectionFields(templateId.toString(), section.id.toString()).subscribe(fields => {\n        section.fields = fields;\n      });\n    }\n  }\n  toggleSections(template) {\n    if (!template.sections) {\n      this.loadSections(template.id);\n    }\n    template.expanded = !template.expanded;\n  }\n  toggleFields(section) {\n    if (!section.fields) {\n      this.loadFields(section);\n    }\n    section.expanded = !section.expanded;\n  }\n  static #_ = this.ɵfac = function TemplateDetailsComponent_Factory(t) {\n    return new (t || TemplateDetailsComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.TemplateService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TemplateDetailsComponent,\n    selectors: [[\"app-template-details\"]],\n    viewQuery: function TemplateDetailsComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.addSectionModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.addFieldModal = _t.first);\n      }\n    },\n    inputs: {\n      template: \"template\"\n    },\n    outputs: {\n      sectionUpdated: \"sectionUpdated\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 15,\n    vars: 2,\n    consts: [[1, \"template-details-container\"], [1, \"section-list\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [\"addSectionModal\", \"\"], [\"addFieldModal\", \"\"], [1, \"section-item\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"btn\", \"btn-info\", 3, \"click\"], [4, \"ngIf\"], [1, \"field-item\"], [1, \"modal-content\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"title\"], [\"type\", \"text\", \"formControlName\", \"title\", \"id\", \"title\", 1, \"form-control\"], [\"for\", \"type\"], [\"formControlName\", \"type\", \"id\", \"type\", 1, \"form-control\"], [\"value\", \"Form\"], [\"value\", \"Table\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"value\", \"Text\"], [\"value\", \"Number\"], [\"value\", \"Date\"], [\"value\", \"Boolean\"], [\"for\", \"isRequired\"], [\"type\", \"checkbox\", \"formControlName\", \"isRequired\", \"id\", \"isRequired\", 1, \"form-check-input\"]],\n    template: function TemplateDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"h3\");\n        i0.ɵɵtext(5, \"Sections\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 2);\n        i0.ɵɵlistener(\"click\", function TemplateDetailsComponent_Template_button_click_6_listener() {\n          return ctx.editSection(ctx.template.id);\n        });\n        i0.ɵɵtext(7, \"Add Section\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(8, TemplateDetailsComponent_div_8_Template, 11, 3, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"modal\", null, 4);\n        i0.ɵɵtemplate(11, TemplateDetailsComponent_ng_template_11_Template, 18, 3, \"ng-template\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"modal\", null, 5);\n        i0.ɵɵtemplate(14, TemplateDetailsComponent_ng_template_14_Template, 26, 3, \"ng-template\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Template: \", ctx.template.title, \"\");\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.template.sections);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.CheckboxControlValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i4.ModalComponent, i1.FormGroupDirective, i1.FormControlName],\n    encapsulation: 2\n  });\n}","map":{"version":3,"mappings":"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","names":["EventEmitter","Validators","Swal","i0","TemplateDetailsComponent","constructor","fb","templateService","id","title","uniqeCode","sections","initSectionForm","initFieldForm","ngOnInit","initForm","loadTemplates","ngOnChanges","changes","console","log","template","sectionParams","group","required","minLength","maxLength","type","fieldParams","isRequired","editSection","templateId","section","selectedTemplateId","addSectionModal","open","setValue","saveSection","invalid","showMessage","value","addSectionDTO","mapSectionType","updateSection","toString","subscribe","templateList","find","t","existingSection","s","Object","assign","close","error","handleErrorResponse","addSection","newSection","push","sectionTypeMap","JSON","stringify","message","msg","fire","icon","toast","position","showConfirmButton","timer","customClass","container","deleteSection","sectionId","filter","loadSections","getTemplateById","existingTemplate","getTemplateIdBySectionId","undefined","editField","field","selectedSectionId","addFieldModal","saveField","addFieldDTO","mapFieldType","updateField","updatedField","fields","index","findIndex","f","slice","addField","newField","fieldTypeMap","deleteField","fieldId","loadFields","getSectionFields","toggleSections","expanded","toggleFields","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\Electronica Care\\Downloads\\QRCodeGenerator-main\\QR-Generator\\src\\app\\qrtemplategenerator\\components\\template-details\\template-details.component.ts","C:\\Users\\Electronica Care\\Downloads\\QRCodeGenerator-main\\QR-Generator\\src\\app\\qrtemplategenerator\\components\\template-details\\template-details.component.html"],"sourcesContent":["import { Component, Input, Output, ViewChild , EventEmitter, SimpleChanges  } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ModalComponent } from 'angular-custom-modal';\nimport Swal from 'sweetalert2';\nimport { TemplateService } from 'src/app/qrtemplategenerator/services/template.service';\nimport { Template } from 'src/app/qrtemplategenerator/Models/Template';\nimport { Section } from 'src/app/qrtemplategenerator/Models/Section';\nimport { Field } from 'src/app/qrtemplategenerator/Models/Field';\n\n\n@Component({\n  selector: 'app-template-details',\n  templateUrl: './template-details.component.html'\n})\nexport class TemplateDetailsComponent {\n  @Input() template: Template = {\n    id: 0,\n    title: '',\n    uniqeCode: '',\n    sections: []\n  };\n  \n  @Output() sectionUpdated = new EventEmitter<void>(); \n  @ViewChild('addSectionModal') addSectionModal!: ModalComponent;\n  @ViewChild('addFieldModal') addFieldModal!: ModalComponent;\n\n  sectionParams!: FormGroup;\n  fieldParams!: FormGroup;\n  selectedSection?: Section;\n\n\n  \n  selectedTemplateId: number | null = null;\n  selectedSectionId: number | null = null;\n  templateList: Template[] = [];\n\n\n  \n\n  constructor(private fb: FormBuilder, private templateService: TemplateService) {\n    this.initSectionForm();\n    this.initFieldForm();\n  }\n \n   ngOnInit() {\n    this.initForm();\n    this.initSectionForm();\n    this.initFieldForm();\n    this.loadTemplates();\n  }yyyyy\n  \n  ngOnChanges(changes: SimpleChanges) {\n    if (changes['template']) {\n      console.log('Template received in child component:', this.template);\n    }\n  }\n  \n  \n  \n\n  initSectionForm() {\n    this.sectionParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required],\n    });\n  }\n\n  initFieldForm() {\n    this.fieldParams = this.fb.group({\n      id: [0],\n      title: ['', [Validators.required, Validators.minLength(3), Validators.maxLength(100)]],\n      type: ['', Validators.required],\n      isRequired: [false],\n    });\n  }\n\n  // Section methods\n  editSection(templateId: number, section: Section | null = null) {\n    this.selectedTemplateId = templateId;\n    this.addSectionModal.open();\n    this.initSectionForm();\n    if (section) {\n      this.sectionParams.setValue({\n        id: section.id,\n        title: section.title,\n        type: section.type,\n      });\n    }\n  }\n\n  saveSection() {\n    if (this.sectionParams.invalid) {\n      this.showMessage('Please fill all required fields.', 'error');\n      return;\n    }\n  \n    const section: Section = this.sectionParams.value;\n    const templateId = this.selectedTemplateId;\n  \n    \n  \n    if (templateId !== null) {\n      const addSectionDTO = {\n        title: section.title,\n        type: this.mapSectionType(section.type) \n      };\n  \n   \n  \n      if (section.id) {\n       \n        this.templateService.updateSection(templateId.toString(), section.id.toString(), addSectionDTO)\n          .subscribe(\n            () => {\n              const template = this.templateList.find(t => t.id === templateId);\n              if (template && template.sections) {\n                const existingSection = template.sections.find(s => s.id === section.id);\n                if (existingSection) {\n                  Object.assign(existingSection, section);\n                }\n              }\n              this.showMessage('Section has been updated successfully.');\n              this.addSectionModal.close();\n            },\n            (error) => this.handleErrorResponse(error)\n          );\n      } else {\n       \n        this.templateService.addSection(templateId.toString(), addSectionDTO)\n          .subscribe(\n            (newSection) => {\n              const template = this.templateList.find(t => t.id === templateId);\n              if (template) {\n                if (!template.sections) {\n                  template.sections = [];\n                }\n                template.sections.push(newSection);\n              }\n              this.showMessage('Section has been added successfully.');\n              \n              this.addSectionModal.close();\n             \n            },\n            (error) => this.handleErrorResponse(error)\n          );\n      }\n    }\n  }\n  \n \n  private mapSectionType(type: any): number {\n    const sectionTypeMap: { [key: string]: number } = {\n      'Form': 0,\n      'Table': 1,\n    };\n    return sectionTypeMap[type] ?? 0; \n  }\n  private handleErrorResponse(error: any) {\n    console.error('Error response:', error);\n    console.error('Error details:', JSON.stringify(error.error));\n    this.showMessage(error.error?.message || 'An unknown error occurred!', 'error');\n  }\n\n\n  showMessage(msg: string, type: 'success' | 'error' = 'success') {\n    Swal.fire({\n      icon: type,\n      title: msg,\n      toast: true,\n      position: 'top',\n      showConfirmButton: false,\n      timer: 3000,\n      customClass: { container: 'toast' },\n    });\n  }\n    deleteSection(templateId: number, sectionId: number) {\n      this.templateService.deleteSection(templateId.toString(), sectionId.toString()).subscribe(() => {\n        const template = this.templateList.find(t => t.id === templateId);\n        if (template && template.sections) {\n          template.sections = template.sections.filter(s => s.id !== sectionId);\n        }\n        this.showMessage('Section has been deleted successfully.');\n      }, error => {\n        this.showMessage(error, 'error');\n      });\n    }\n    loadSections(templateId: number) {\n      this.templateService.getTemplateById(templateId.toString()).subscribe((template) => {\n        const existingTemplate = this.templateList.find(t => t.id === templateId);\n        if (existingTemplate) {\n          existingTemplate.sections = template.sections;\n        }\n      });\n    }\n    getTemplateIdBySectionId(sectionId: number): number | undefined {\n      for (const template of this.templateList) {\n        if (template.sections) { \n          for (const section of template.sections) {\n            if (section.id === sectionId) {\n              return template.id;\n            }\n          }\n        }\n      }\n      return undefined;\n    }\n  \n\n  // Field methods\n  editField(section: Section, field: Field | null = null) {\n    this.selectedSectionId = section.id;\n    const templateId = this.getTemplateIdBySectionId(section.id);\n    this.selectedTemplateId = templateId !== undefined ? templateId : null; \n    this.addFieldModal.open();  \n    this.initFieldForm();  \n    if (field) {\n      this.fieldParams.setValue({\n        id: field.id,\n        title: field.title,\n        type: field.type,\n        isRequired: field.isRequired,\n      });\n    }\n  }\n\n  saveField() {\n   \n    \n    if (this.fieldParams.invalid) {\n      this.showMessage('Please fill all required fields.', 'error');\n      return;\n    }\n  \n    const field: Field = this.fieldParams.value;\n    const sectionId = this.selectedSectionId;\n    const templateId = this.selectedTemplateId;\n  \n  \n  \n    if (templateId != null && sectionId != null) {\n      const addFieldDTO = {\n        title: field.title,\n        type: this.mapFieldType(field.type), // Convert type correctly\n        isRequired: field.isRequired,\n      };\n  \n    \n  \n      if (field.id != null && field.id !== 0) {\n       \n       // In saveField() update case\nthis.templateService.updateField(templateId.toString(), sectionId.toString(), field.id.toString(), addFieldDTO)\n.subscribe(\n  (updatedField) => {\n    // Find and update the local field\n    const template = this.templateList.find(t => t.id === templateId);\n    const section = template?.sections?.find(s => s.id === sectionId);\n    \n    if (section?.fields) {\n      const index = section.fields.findIndex(f => f.id === updatedField.id);\n      if (index > -1) {\n        section.fields = [\n          ...section.fields.slice(0, index),\n          updatedField,\n          ...section.fields.slice(index + 1)\n        ];\n      }\n    }\n    \n    this.showMessage('Field updated successfully');\n    this.addFieldModal.close();\n  },\n  (error) => this.handleErrorResponse(error)\n);\n      } else {\n      \n     // In saveField() add case\nthis.templateService.addField(templateId.toString(), sectionId.toString(), addFieldDTO)\n.subscribe(\n  (newField) => {\n    // Find and update the local data\n    const template = this.templateList.find(t => t.id === templateId);\n    const section = template?.sections?.find(s => s.id === sectionId);\n    \n    if (section) {\n      if (!section.fields) section.fields = [];\n      section.fields = [...section.fields, newField]; // Immutable update\n    }\n    \n    this.showMessage('Field added successfully');\n    this.addFieldModal.close();\n  },\n  (error) => this.handleErrorResponse(error)\n);\n      }\n    } else {\n      this.showMessage('Template ID or Section ID is missing.', 'error');\n    }\n  }\n  \n \n  private mapFieldType(type: any): number {\n    const fieldTypeMap: { [key: string]: number } = {\n      'Text': 0,\n      'Number': 1,\n      'Date': 2,\n      'Boolean': 3,\n    };\n    return fieldTypeMap[type]; \n  }\n  deleteField(section: Section, fieldId: number) {\n    const templateId = this.getTemplateIdBySectionId(section.id); \n    \n   \n  \n    if (templateId !== undefined) {  \n      this.templateService.deleteField(templateId.toString(), section.id.toString(), fieldId.toString()).subscribe(() => {\n        const template = this.templateList.find(t => t.id === templateId);\n        const existingSection = template?.sections?.find(s => s.id === section.id);\n        if (existingSection && existingSection.fields) {\n          existingSection.fields = existingSection.fields.filter(f => f.id !== fieldId);\n        }\n        this.showMessage('Field has been deleted successfully.');\n      }, error => {\n        this.showMessage(error, 'error');\n      });\n    } else {\n      this.showMessage('Failed to delete field: Template ID is missing.', 'error');\n    }\n  }\n\n\n  loadFields(section: Section) {\n    const templateId = this.selectedTemplateId;\n    if (templateId !== null) {\n      this.templateService.getSectionFields(templateId.toString(), section.id.toString()).subscribe((fields) => {\n        section.fields = fields;\n      });\n    }\n  }\n\n  toggleSections(template: any) {\n    if (!template.sections) {\n      this.loadSections(template.id);\n    }\n    template.expanded = !template.expanded;\n  }\n  \n  toggleFields(section: any) {\n    if (!section.fields) {\n      this.loadFields(section);\n    }\n    section.expanded = !section.expanded;\n  }\n}","<div class=\"template-details-container\">\n  <h2>Template: {{ template.title }}</h2>\n\n  <!-- Sections Section -->\n  <div class=\"section-list\">\n    <h3>Sections</h3>\n    <button class=\"btn btn-primary\" (click)=\"editSection(template.id)\">Add Section</button>\n\n    <div *ngFor=\"let section of template.sections\">\n      <div class=\"section-item\">\n        <h4>{{ section.title }}</h4>\n        <button class=\"btn btn-secondary\" (click)=\"editSection(template.id, section)\">Edit</button>\n        <button class=\"btn btn-danger\" (click)=\"deleteSection(template.id, section.id)\">Delete</button>\n        <button class=\"btn btn-info\" (click)=\"toggleFieldsVisibility(section)\">\n          {{ section.expanded ? 'Hide' : 'Show' }} Fields\n        </button>\n\n        <!-- Fields -->\n        <div *ngIf=\"section.expanded\">\n          <div *ngFor=\"let field of section.fields\">\n            <div class=\"field-item\">\n              <span>{{ field.title }} ({{ field.type }})</span>\n              <button class=\"btn btn-secondary\" (click)=\"editField(section, field)\">Edit</button>\n              <button class=\"btn btn-danger\" (click)=\"deleteField(section, field.id)\">Delete</button>\n            </div>\n          </div>\n          <button class=\"btn btn-primary\" (click)=\"editField(section)\">Add Field</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Section Modal -->\n  <modal #addSectionModal>\n    <ng-template let-modal>\n      <div class=\"modal-content\">\n        <h4>{{ sectionParams.value.id ? 'Edit' : 'Add' }} Section</h4>\n        <form [formGroup]=\"sectionParams\" (ngSubmit)=\"saveSection()\">\n          <div class=\"form-group\">\n            <label for=\"title\">Section Title</label>\n            <input type=\"text\" formControlName=\"title\" class=\"form-control\" id=\"title\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"type\">Section Type</label>\n            <select formControlName=\"type\" class=\"form-control\" id=\"type\">\n              <option value=\"Form\">Form</option>\n              <option value=\"Table\">Table</option>\n            </select>\n          </div>\n          <button class=\"btn btn-primary\" type=\"submit\" [disabled]=\"sectionParams.invalid\">Save</button>\n        </form>\n      </div>\n    </ng-template>\n  </modal>\n\n  <!-- Field Modal -->\n  <modal #addFieldModal>\n    <ng-template let-modal>\n      <div class=\"modal-content\">\n        <h4>{{ fieldParams.value.id ? 'Edit' : 'Add' }} Field</h4>\n        <form [formGroup]=\"fieldParams\" (ngSubmit)=\"saveField()\">\n          <div class=\"form-group\">\n            <label for=\"title\">Field Title</label>\n            <input type=\"text\" formControlName=\"title\" class=\"form-control\" id=\"title\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"type\">Field Type</label>\n            <select formControlName=\"type\" class=\"form-control\" id=\"type\">\n              <option value=\"Text\">Text</option>\n              <option value=\"Number\">Number</option>\n              <option value=\"Date\">Date</option>\n              <option value=\"Boolean\">Boolean</option>\n            </select>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"isRequired\">Required</label>\n            <input type=\"checkbox\" formControlName=\"isRequired\" class=\"form-check-input\" id=\"isRequired\" />\n          </div>\n          <button class=\"btn btn-primary\" type=\"submit\" [disabled]=\"fieldParams.invalid\">Save</button>\n        </form>\n      </div>\n    </ng-template>\n  </modal>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}